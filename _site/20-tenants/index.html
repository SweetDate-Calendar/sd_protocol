<h1 id="tenants--command-reference">TENANTS — Command Reference</h1>

<p>This page specifies commands for working with tenants, tenant–user associations, and tenant–calendar associations.<br />
Each section documents parameters, response types, and examples.</p>

<hr />

<h3 id="list_tenants">LIST_TENANTS</h3>
<p>Returns tenants ordered by name ascending.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/tenants?limit=25&amp;offset=0
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "result": {
    "tenants": [
      {
        "id": "00000000-0000-0000-0000-000000000000",
        "name": "Alpha",
        "account_id": "acc-123",
        "inserted_at": "2025-08-18T09:20:00Z",
        "updated_at": "2025-08-19T10:15:00Z"
      }
    ],
    "limit": 25,
    "offset": 0
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="create">CREATE</h3>
<p>Create a new tenant.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/v1/tenants
{
  "name": "Building 4"
}
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "tenant": {
    "id": "00000000-0000-0000-0000-000000000000",
    "name": "Building 4",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="get">GET</h3>
<p>Get a single tenant by ID.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/tenants/:id
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "tenant": {
    "id": "00000000-0000-0000-0000-000000000000",
    "name": "Terminal 23",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="update">UPDATE</h3>
<p>Update an existing tenant.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PUT /api/v1/tenants/:id
{
  "name": "Terminal 3 3/4"
}
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "tenant": {
    "id": "00000000-0000-0000-0000-000000000000",
    "name": "Terminal 3 3/4",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="delete">DELETE</h3>
<p>Delete a tenant.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DELETE /api/v1/tenants/:id
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"status": "ok"}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="list_users">LIST_USERS</h3>
<p>List all tenant users.</p>
<blockquote>
  <p>Optional query params:</p>
  <ul>
    <li><strong>limit</strong> – Maximum number of users to return (default: 25)</li>
    <li><strong>offset</strong> – Number of users to skip before starting to return results (default: 0)</li>
    <li><strong>q</strong> – Search term (matches against user name or email)</li>
  </ul>
</blockquote>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/tenants/:tenant_id/users?limit=10&amp;offset=20&amp;q=alice
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "users": [
    {
      "id": "00000000-0000-0000-0000-000000000000", 
      "name": "some name",
      "email": "some-email@example.com"
      "role": "owner", 
      "inserted_at": "2025-08-18T09:20:00Z",
      "updated_at": "2025-08-19T10:15:00Z"
    },
    {
      "id": "00000000-0000-0000-0000-000000000000", 
      "name": "Some other name",
      "email": "some-other-email@example.com",
      "role": "admin",
      "inserted_at": "2025-08-18T09:20:00Z",
      "updated_at": "2025-08-19T10:15:00Z"
    }
  ]
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "error",
  "message": "not found",
  "error_code": "NOT_FOUND"
}
</code></pre></div></div>

<hr />

<h3 id="create_user">CREATE_USER</h3>
<p>Create a tenant–user association.</p>

<blockquote>
  <p>Permitted values for <code class="language-plaintext highlighter-rouge">role</code>:</p>
  <ul>
    <li><strong>owner</strong> – Owns the calendar and can delete it</li>
    <li><strong>admin</strong> – Edit</li>
    <li><strong>guest</strong> – Show</li>
  </ul>
</blockquote>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/v1/tenants/:tenant_id/users
{
  "user_id": "00000000-0000-0000-0000-000000000000",
  "role": "admin"
}
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "user": {
    "id": "00000000-0000-0000-0000-000000000000",
    "email": "some-name@example.com,
    "name": "some name",
    "role": "admin",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Error</strong> 404 Not Found</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 
  {
    "status": "error",
    "message": "not found",
    "error_code": "NOT_FOUND"
  }
</code></pre></div></div>
<p><strong>Error</strong>   422 Unprocessable Entity</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "error",
  "message": "invalid input",
  "error_code": "VALIDATION_ERROR",
  "fields": {
    "user_id": ["is not a valid UUID"],
    "role": ["is invalid"]  # when enum cast fails
  }
}
</code></pre></div></div>

<hr />

<h3 id="get_user">GET_USER</h3>
<p>Get a tenant user by ID.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/tenants/:tenant_id/users/:id
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "user": {
    "id": "00000000-0000-0000-0000-000000000000",
    "name": "Some name",
    "email": "some-name@example.com",
    "role": "owner",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%{
  "status" =&gt; "error",
  "error_code" =&gt; "VALIDATION_ERROR",
  "fields" =&gt; %{"role" =&gt; ["is invalid"]},
  "message" =&gt; "invalid input"****
}
</code></pre></div></div>

<hr />

<h3 id="update_user">UPDATE_USER</h3>
<p>Update a tenant user.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PUT /api/v1/tenants/:tenant_id/users/:id
{
  "role": "admin"
}
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "user": {
    "id": "00000000-0000-0000-0000-000000000000",
    "name": "Some name",
    "email": "some-name@example.com",
    "role": "admin",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Errors</strong> 422 Unprocessable Entity</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "error",
  "message": "invalid input",
  "error_code": "VALIDATION_ERROR",
  "fields": {
    "role": ["is invalid"]
  }
}
</code></pre></div></div>
<p><strong>Errors</strong> 404 Not Found</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "error",
  "message": "not found",
  "error_code": "NOT_FOUND"
}
</code></pre></div></div>

<hr />

<h3 id="delete_user">DELETE_USER</h3>
<p>Delete a tenant user.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DELETE /api/v1/tenants/:tenant_id/users/:id
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"status": "ok"}
</code></pre></div></div>

<p><strong>Errors</strong> 404 Not Found</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "error",
  "message": "not found",
  "error_code": "NOT_FOUND"
}
</code></pre></div></div>

<hr />

<h3 id="list_calendars">LIST_CALENDARS</h3>
<p>List all calendars attached to a tenant.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/tenants/:tenant_id/calendars
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "calendars": [
    { 
      "id": "00000000-0000-0000-0000-000000000000", 
      "name": "Some name",
      "color_theme": "red",
      "visibility": "shared",
      "inserted_at": "2025-08-18T09:20:00Z",
      "updated_at": "2025-08-19T10:15:00Z"

    },
    { 
      "id": "00000000-0000-0000-0000-000000000000", 
      "name": "Some other name",
      "color_theme": "blue"
      "visibility": "shared",
      "inserted_at": "2025-08-18T09:20:00Z",
      "updated_at": "2025-08-19T10:15:00Z"
    }
  ]
}
</code></pre></div></div>

<p><strong>Errors</strong> 404 Not Found</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "error",
  "message": "not found",
  "error_code": "NOT_FOUND"
}
</code></pre></div></div>

<hr />

<h3 id="create_calendar">CREATE_CALENDAR</h3>
<p>Attach a calendar to a tenant.</p>
<blockquote>
  <p>Permitted values for <code class="language-plaintext highlighter-rouge">visibility</code>:</p>
  <ul>
    <li><strong>private</strong> – Only the owner has access</li>
    <li><strong>shared</strong> – Shared with selected users</li>
    <li><strong>public</strong> – Discoverable within the tenant</li>
    <li><strong>unlisted</strong> – Hidden from discovery, link/ID required</li>
  </ul>
</blockquote>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/v1/tenants/:tenant_id/calendars
{
  "calendar_id": "00000000-0000-0000-0000-000000000000",
}
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "calendar": { 
    "id": "00000000-0000-0000-0000-000000000000", 
    "name": "Some name",
    "color_theme": "red",
    "visibility": "shared",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z"
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="get_calendar">GET_CALENDAR</h3>
<p>Get a tenant calendar by ID, including its associated users</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/tenants/:tenant_id/calendars/:id
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "status": "ok",
  "calendar": {
    "id": "00000000-0000-0000-0000-000000000000",
    "name": "Some calendar",
    "color_theme": "white",
    "visibility": "private",
    "inserted_at": "2025-08-18T09:20:00Z",
    "updated_at": "2025-08-19T10:15:00Z",
    "users": [
      {
        "id": "00000000-0000-0000-0000-000000000000",
        "name": "Some name",
        "email": "some-name@example.com",
        "role": "owner",
        "inserted_at": "2025-08-18T09:20:00Z",
        "updated_at": "2025-08-19T10:15:00Z"
      },
      {
        "id": "00000000-0000-0000-0000-000000000000",
        "name": "Some other name",
        "email": "some-other-name@example.com",
        "role": "admin",
        "inserted_at": "2025-08-18T09:20:00Z",
        "updated_at": "2025-08-19T10:15:00Z"
      }
    ]
  }
}
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { "status": "error", "message": "..." }
</code></pre></div></div>

<hr />

<h3 id="delete_calendar">DELETE_CALENDAR</h3>
<p>Delete a tenant calendar association.</p>

<p><strong>Request</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DELETE /api/v1/tenants/:tenant_id/calendars/:id
</code></pre></div></div>

<p><strong>Response</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "status": "ok" }
</code></pre></div></div>

<p><strong>Error</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { "status": "error", "message": "..." }
</code></pre></div></div>
