<h1 id="command-definition-format">Command Definition Format</h1>

<p>This document describes how the JSON specification for commands maps to generated documentation and client libraries.<br />
It serves as a guide for developers who want to add or extend commands in the protocol.</p>

<hr />

<h2 id="structure">Structure</h2>

<p>Each context (e.g. <code class="language-plaintext highlighter-rouge">TENANTS</code>, <code class="language-plaintext highlighter-rouge">CALENDARS</code>) contains a <code class="language-plaintext highlighter-rouge">commands</code> array.<br />
Each command is defined as an object with the following fields:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ MODEL_NAMES: 
  {
    "name": "SOME_COMAND",
    "url: "api/v1/SOME_ENDPOINT"
    "description": "Some description",
    "params": {
      "SOME_PARAM": {
        "type": "integer",
        "required": false,
        "default": 25,
        "min": 1,
        "max": 100,
        "description": "Some description."
      },
      "SOME_OTHER_PARAM": {
        "type": "integer",
        "required": false,
        "default": 0,
        "min": 0,
        "description": "Some description."
      }
    },
    "response": {
      "type": "SOME_COMAND",
      "description": "Some description).",
      "example": { "...": "..." },
      "error_example": { "...": "..." }
    }
  },
  {
    "name": "SOME_OTHER_COMAND",
    ...
  }
}
</code></pre></div></div>

<hr />

<h2 id="field-mapping">Field Mapping</h2>
<h3 id="model_names"><code class="language-plaintext highlighter-rouge">MODEL_NAMES</code></h3>
<ul>
  <li><strong>Purpose:</strong> Unique identifier of context the commands is working on (e.g. <code class="language-plaintext highlighter-rouge">TENANTS</code>, <code class="language-plaintext highlighter-rouge">USERS</code>).</li>
  <li><strong>Documentation:</strong> Becomes the section title in the reference.</li>
  <li><strong>Client Libraries:</strong> Used as the function/method name.</li>
</ul>

<h3 id="name"><code class="language-plaintext highlighter-rouge">name</code></h3>
<ul>
  <li><strong>Purpose:</strong> Unique identifier of the command (e.g. <code class="language-plaintext highlighter-rouge">GET_LIST</code>, <code class="language-plaintext highlighter-rouge">CREATE</code>).</li>
  <li><strong>Documentation:</strong> Becomes the section title in the reference.</li>
  <li><strong>Client Libraries:</strong> Used as the function/method name.</li>
</ul>

<h3 id="description"><code class="language-plaintext highlighter-rouge">description</code></h3>
<ul>
  <li><strong>Purpose:</strong> Explains what the command does in one sentence.</li>
  <li><strong>Documentation:</strong> Appears below the command title.</li>
  <li><strong>Client Libraries:</strong> Added as a docstring/comment.</li>
</ul>

<h3 id="params"><code class="language-plaintext highlighter-rouge">params</code></h3>
<ul>
  <li><strong>Purpose:</strong> Defines input fields for the command.</li>
  <li><strong>Attributes:</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">type</code>: data type (<code class="language-plaintext highlighter-rouge">string</code>, <code class="language-plaintext highlighter-rouge">integer</code>, <code class="language-plaintext highlighter-rouge">boolean</code>, etc.)</li>
      <li><code class="language-plaintext highlighter-rouge">required</code>: whether the field is mandatory</li>
      <li><code class="language-plaintext highlighter-rouge">default</code>: default value if omitted</li>
      <li><code class="language-plaintext highlighter-rouge">min</code>/<code class="language-plaintext highlighter-rouge">max</code>: numeric constraints</li>
      <li><code class="language-plaintext highlighter-rouge">description</code>: human-readable explanation</li>
    </ul>
  </li>
  <li><strong>Documentation:</strong> Rendered as part of the request example or parameter list.</li>
  <li><strong>Client Libraries:</strong> Used for validation and function signatures.</li>
</ul>

<h3 id="response"><code class="language-plaintext highlighter-rouge">response</code></h3>
<ul>
  <li><strong>Purpose:</strong> Defines the structure of the commandâ€™s response.</li>
  <li><strong>Attributes:</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">type</code>: symbolic type (e.g. <code class="language-plaintext highlighter-rouge">tenant</code>, <code class="language-plaintext highlighter-rouge">tenant_list</code>)</li>
      <li><code class="language-plaintext highlighter-rouge">description</code>: what the response represents</li>
      <li><code class="language-plaintext highlighter-rouge">example</code>: JSON payload of a successful result</li>
      <li><code class="language-plaintext highlighter-rouge">error_example</code>: JSON payload of an error case</li>
    </ul>
  </li>
  <li><strong>Documentation:</strong> Rendered under <strong>Response</strong> and <strong>Error</strong> examples.</li>
  <li><strong>Client Libraries:</strong> Defines the expected return structure and error handling.</li>
</ul>

<hr />

<h2 id="example-mapping">Example Mapping</h2>

<h3 id="json-definition">JSON Definition</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ TENANTS:
  {
    "name": "GET_LIST",
    "description": "Returns tenants ordered by name ascending.",
    "params": {
      "limit": { "type": "integer", "required": false, "default": 25 },
      "offset": { "type": "integer", "required": false, "default": 0 }
    },
    "response": {
      "type": "tenant_list",
      "description": "Paginated list of tenants (ordered by name asc).",
      "example": { "status": "ok", "result": { "items": [] } },
      "error_example": { "error": "invalid", "details": {} }
    }
  }
}
</code></pre></div></div>

<h3 id="generated-documentation">Generated Documentation</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>### GET_LIST
Returns tenants ordered by name ascending.

**Request**
GET /api/v1/tenants?limit=25&amp;offset=0

**Response**
{ "status": "ok", "result": { "items": [] } }

**Error**
{ "error": "invalid", "details": {} }
</code></pre></div></div>

<h3 id="client-library-pseudo-code">Client Library (Pseudo-code)</h3>
<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="n">list_tenants</span><span class="p">(</span><span class="n">limit</span> <span class="p">\</span> <span class="mi">25</span><span class="p">,</span> <span class="n">offset</span> <span class="p">\</span> <span class="mi">0</span><span class="p">)</span> <span class="k">do</span>
  <span class="s2">"REST endpoing"</span> <span class="s2">"api/v1/tennants/{params}"</span>
  <span class="s2">"REST endpoint: TENANTS.GET_LIST"</span> 
  <span class="c1"># lets rethink send_command, i beleive api interface should be read from an environment variable in the client</span>
  <span class="c1">#send_command("TENANTS.GET_LIST", %{limit: limit, offset: offset})</span>
<span class="k">end</span>
</code></pre></div></div>

<hr />

<h2 id="extending-the-protocol">Extending the Protocol</h2>

<ol>
  <li>Add a new command block under the appropriate context (e.g. <code class="language-plaintext highlighter-rouge">TENANTS</code>).</li>
  <li>Define <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">description</code>, <code class="language-plaintext highlighter-rouge">params</code>, and <code class="language-plaintext highlighter-rouge">response</code>.</li>
  <li>Regenerate documentation and client libraries from the JSON file.</li>
</ol>

<p>This ensures consistent behavior across all supported languages.</p>
